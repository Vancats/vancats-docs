---
date created: 2022-03-06 15:02
date updated: 2022-03-06 21:58
---

### 浏览器安全

#### XSS 攻击

**恶意操作**

- 获取页面数据，cookie，localStorage
- DOS攻击，发送合理请求，占用服务器资源
- 破坏页面结构
- 流量劫持，将链接指向其他网站

**攻击类型**

- 存储型：存储在服务器上，用户请求时返回并执行
- 反射型：诱导用户访问一个带有恶意代码的URL，服务器端接受处理后，把带有恶意代码的数据发送到浏览器端，浏览器解析后当作正常脚本执行，实现XSS攻击
- DOM型：通过修改页面的DOM节点

**攻击步骤**

- 存储型：论坛发帖、商品评论、用户私信等需要保存数据的网站
	1. 攻击者提交恶意代码到目标网站数据库
	2. 用户打开网站时，服务器取出恶意代码拼接成HTML返回给浏览器
	3. 浏览器解析
	4. 恶意代码窃取用户信息并发送到攻击者网站，或冒充用户行为执行指定操作（_XSS 统一操作_）

- 反射型：网站搜索，跳转等通过URL传参的功能；和存储型的区别是一个存在数据库，一个在URL中
	1. 攻击者构造包含恶意代码的URL
	2. 用户打开URL，服务器取出URL中的恶意代码拼接成HTML返回给浏览器
	3. 浏览器解析
	4. XSS 统一操作

- DOM型：这种是前端 JS 自身漏洞，其他两种都是服务端的漏洞
	1. 攻击者构造包含恶意代码的URL
	2. 用户打开该URL
	3. 用户浏览器接收到响应后解析，JS 取出 URL 的恶意代码并执行
	4. XSS 统一操作

**如何防御**

1. 纯前端方式，不实用服务端拼接返回内容（服务端渲染）
2. 对需要插入到 HTML 中的代码做好充分转义，如 script 标签等
3. 保护敏感信息，对 cookie 使用 http-only
4. 使用验证码，避免脚本伪装成用户操作
5. 使用 CSP，建立白名单，告知浏览器可执行的资源；可以设置 Content-Security-Policy 或者 meta 标签

#### CSRF 攻击

跨站请求伪造攻击，诱导用户进入第三方网站，该网站发送跨站请求，如果用户保留了登陆状态，就可以绕过后台验证执行操作

**本质**：cookie 会在同源请求中携带发送给服务器

**攻击类型**
- GET类型：在网站的 img 标签中添加请求，打开网站自动提交
- POST类型：构建隐藏的表单，打开网站自动提交
- 链接类型：a 标签的 href 属性，诱导用户点击

**如何防御**
