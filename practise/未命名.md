---
date created: 2022-04-24 16:55
date updated: 2022-04-24 17:51
---

#### 长任务

概念：运行时间超过 50ms 的任务

原因：长任务下，用户会感知到渲染和交互上的卡顿

##### 时间切片方法

处理方法：首先将该任务改成一个 `generate` 函数，使其可异步，然后通过宏任务方法（一般使用 `setTimeout`）推入宏任务队列，使其延迟执行，从而不影响主执行栈。

**例子**

```js
function fnc() {
  let i = 0
  const start = performance.now()
  while (performance.now() - start <= 5000) i++
  return i
}
```

这是一个很明显的长任务，执行时间为 5000 ms，如果不处理的话，在执行这段代码的时候，会很明显的感知到卡顿现象。

```js
function* fn() {
  let i = 0
  const start = performance.now()
  while (performance.now() - start <= 5000)
    yield i++
  return i
}
```

首先转换成一个 `generate` 函数以便后续处理。

###### web worker
